<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FAQ - FHIRHub</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/admin.css">
    <link rel="stylesheet" href="/css/sidebar-menu.css">
    <link rel="stylesheet" href="/css/faq.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <script src="/js/auth-utils.js" defer></script>
    <script src="/js/include-sidebar.js" defer></script>
    <script src="/js/sidebar-menu-new.js" defer></script>
    <script src="/js/footer-version.js" defer></script>
    <script src="/js/modern-dialogs.js" defer></script>
    <script src="/js/faq.js" defer></script>
</head>
<body>
    <div class="app-container">
        <div class="main-content">
            <h1>Foire Aux Questions (FAQ)</h1>
            <div class="faq-content">
                <div class="faq-header">
                    <h2>Système de terminologie - Questions fréquentes</h2>
                    <p>Ce document regroupe les questions fréquemment posées sur le système de terminologie de FHIRHub.</p>
                </div>

                <div class="faq-sections">
                    <div class="faq-section">
                        <h3>Fonctionnement des terminologies</h3>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <span class="faq-icon">Q</span>
                                <h4>Comment fonctionne techniquement le système de terminologie ?</h4>
                            </div>
                            <div class="faq-answer">
                                <span class="faq-icon">R</span>
                                <div class="faq-answer-content">
                                    <p>Le système utilise un répertoire principal <code>french_terminology/</code> qui contient :</p>
                                    <ul>
                                        <li>Des fichiers de base ANS (Agence du Numérique en Santé) :
                                            <ul>
                                                <li><code>ans_common_codes.json</code> : Codes communs pour la conversion</li>
                                                <li><code>ans_oids.json</code> : Identifiants OID français</li>
                                                <li><code>ans_terminology_systems.json</code> : Systèmes de terminologie standardisés</li>
                                            </ul>
                                        </li>
                                        <li>Des fichiers FHIR supplémentaires</li>
                                        <li>Des sauvegardes automatiques (préfixe <code>backup_</code>)</li>
                                    </ul>
                                    <p>Le système inclut un mécanisme de lecture robuste, des sauvegardes automatiques, et un fallback pour garantir une fiabilité totale.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <span class="faq-icon">Q</span>
                                <h4>Que se passe-t-il si je retire un fichier de terminologie ?</h4>
                            </div>
                            <div class="faq-answer">
                                <span class="faq-icon">R</span>
                                <div class="faq-answer-content">
                                    <p>Si vous supprimez un fichier standard comme <code>ans_common_codes.json</code> :</p>
                                    <ol>
                                        <li>Le système détecte automatiquement que le fichier principal est manquant</li>
                                        <li>Il recherche sa sauvegarde <code>backup_ans_common_codes.json</code></li>
                                        <li>Si la sauvegarde existe, son contenu est utilisé</li>
                                        <li>Si même la sauvegarde est absente, un fichier minimal est généré automatiquement</li>
                                    </ol>
                                    <p>Cette architecture robuste assure que le système ne plantera jamais à cause d'un fichier manquant.</p>
                                </div>
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question">
                                <span class="faq-icon">Q</span>
                                <h4>Que sont les fichiers backup_ans ?</h4>
                            </div>
                            <div class="faq-answer">
                                <span class="faq-icon">R</span>
                                <div class="faq-answer-content">
                                    <p>Les fichiers avec le préfixe <code>backup_</code> sont des sauvegardes automatiques créées par le système :</p>
                                    <ul>
                                        <li><code>backup_ans_common_codes.json</code> est une sauvegarde de <code>ans_common_codes.json</code></li>
                                        <li><code>backup_ans_oids.json</code> est une sauvegarde de <code>ans_oids.json</code></li>
                                        <li>etc.</li>
                                    </ul>
                                    <p>Ces sauvegardes sont générées automatiquement :</p>
                                    <ul>
                                        <li>À chaque lecture réussie d'un fichier</li>
                                        <li>Avant chaque mise à jour d'un fichier existant</li>
                                    </ul>
                                    <p>Elles servent de protection contre les corruptions et permettent la restauration en cas de problème.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="faq-section">
                        <h3>Gestion des fichiers</h3>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <span class="faq-icon">Q</span>
                                <h4>Que se passe-t-il si j'ai des informations en doublon dans différents fichiers ?</h4>
                            </div>
                            <div class="faq-answer">
                                <span class="faq-icon">R</span>
                                <div class="faq-answer-content">
                                    <p>Si le même code (par exemple un code de terminologie) apparaît dans plusieurs fichiers :</p>
                                    <ol>
                                        <li><strong>Priorité par nom de fichier :</strong> Les fichiers ANS standards sont prioritaires</li>
                                        <li>Lors de la conversion, le premier fichier dans l'ordre de priorité "gagne"</li>
                                        <li>Les définitions suivantes sont ignorées</li>
                                        <li>Le système enregistre une alerte mais continue de fonctionner</li>
                                    </ol>
                                    <p>L'outil d'analyse de terminologie (<code>/api/terminology/analyze</code>) détecte et signale ces doublons.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <span class="faq-icon">Q</span>
                                <h4>Si je mets 3 fois le même fichier ANS avec des noms différents, que se passe-t-il ?</h4>
                            </div>
                            <div class="faq-answer">
                                <span class="faq-icon">R</span>
                                <div class="faq-answer-content">
                                    <p>Si vous avez plusieurs copies du même fichier ANS (par exemple <code>ans_oids.json</code>, <code>ans_oids_copie1.json</code>, <code>ans_oids_copie2.json</code>) :</p>
                                    <ul>
                                        <li>Les 3 fichiers seront traités comme des entités distinctes</li>
                                        <li>Le code recherche <strong>spécifiquement</strong> les fichiers par leur nom exact</li>
                                        <li>Seul le fichier avec le nom standard (<code>ans_oids.json</code>) sera utilisé pour la conversion</li>
                                        <li>Les copies n'offrent aucun avantage et consomment de l'espace inutilement</li>
                                    </ul>
                                    <p>Pour une gestion optimale, conservez un seul exemplaire de chaque fichier avec son nom standard.</p>
                                </div>
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question">
                                <span class="faq-icon">Q</span>
                                <h4>Si je mets à jour un fichier avec le même nom, comment le système réagit-il ?</h4>
                            </div>
                            <div class="faq-answer">
                                <span class="faq-icon">R</span>
                                <div class="faq-answer-content">
                                    <p>Quand vous téléversez un fichier avec le même nom qu'un fichier existant :</p>
                                    <ol>
                                        <li>Le système fait une sauvegarde de l'ancien fichier automatiquement</li>
                                        <li>Le nouveau fichier remplace totalement l'ancien</li>
                                        <li>Le cache en mémoire est invalidé et le nouveau contenu est chargé</li>
                                    </ol>
                                    <p>Si le fichier que vous téléversez n'est pas un JSON valide :</p>
                                    <ul>
                                        <li>Le système détecte l'erreur et restaure automatiquement l'ancienne version</li>
                                        <li>Vous recevez un message d'erreur</li>
                                        <li>La continuité de service est maintenue</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question">
                                <span class="faq-icon">Q</span>
                                <h4>Si je mets un fichier avec des informations à jour mais avec un nom différent, est-il utilisé ?</h4>
                            </div>
                            <div class="faq-answer">
                                <span class="faq-icon">R</span>
                                <div class="faq-answer-content">
                                    <p>Si vous ajoutez un fichier avec des données actualisées mais sous un nom différent des standards (<code>nouveaux_codes_ans.json</code> au lieu de <code>ans_common_codes.json</code>) :</p>
                                    <ul>
                                        <li>Le fichier sera bien stocké dans le répertoire</li>
                                        <li>Il sera visible dans l'interface d'administration</li>
                                        <li>Mais il ne sera pas intégré automatiquement dans le processus de conversion</li>
                                    </ul>
                                    <p>Le code cherche explicitement les fichiers avec des noms standards :</p>
                                    <pre><code>const systems = getJsonFileContent('ans_terminology_systems.json');</code></pre>
                                    <p>Pour que vos données actualisées soient utilisées, renommez votre fichier avec le nom standard attendu ou mettez à jour le fichier existant.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="faq-section">
                        <h3>Fonctionnalités et API</h3>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <span class="faq-icon">Q</span>
                                <h4>Quelles API sont disponibles pour les terminologies ?</h4>
                            </div>
                            <div class="faq-answer">
                                <span class="faq-icon">R</span>
                                <div class="faq-answer-content">
                                    <p>Le système expose plusieurs endpoints REST :</p>
                                    <ul>
                                        <li><code>GET /api/terminology/french</code> : Renvoie les systèmes de terminologie français (ANS)</li>
                                        <li><code>GET /api/terminology/files</code> : Liste tous les fichiers de terminologie disponibles</li>
                                        <li><code>GET /api/terminology/files/{filename}</code> : Récupère le contenu d'un fichier spécifique</li>
                                        <li><code>POST /api/terminology/files</code> : Permet de déposer un nouveau fichier</li>
                                        <li><code>POST /api/terminology/analyze</code> : Analyse les fichiers pour générer des statistiques</li>
                                    </ul>
                                    <p>Ces API sont documentées dans la section API Reference.</p>
                                </div>
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question">
                                <span class="faq-icon">Q</span>
                                <h4>Comment le système intègre-t-il les terminologies dans le processus de conversion ?</h4>
                            </div>
                            <div class="faq-answer">
                                <span class="faq-icon">R</span>
                                <div class="faq-answer-content">
                                    <p>Lors de la conversion HL7 vers FHIR :</p>
                                    <ol>
                                        <li>Les services de conversion interrogent les terminologies via la couche d'abstraction</li>
                                        <li>Les mappings de codes sont extraits des fichiers de terminologie</li>
                                        <li>Les identifiants OID français sont traduits vers les URIs FHIR correspondants</li>
                                        <li>Les systèmes de terminologie sont utilisés pour générer des ressources FHIR correctement référencées</li>
                                    </ol>
                                    <p>Cette intégration garantit des conversions complètes et sans perte d'information.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="faq-section">
                        <h3>Recommandations pratiques</h3>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <span class="faq-icon">Q</span>
                                <h4>Quelles sont les meilleures pratiques pour gérer les terminologies ?</h4>
                            </div>
                            <div class="faq-answer">
                                <span class="faq-icon">R</span>
                                <div class="faq-answer-content">
                                    <p>Pour une gestion optimale du système :</p>
                                    <ol>
                                        <li>Conservez un seul exemplaire de chaque fichier ANS standard avec son nom exact</li>
                                        <li>Pour les fichiers personnalisés, utilisez des noms distincts et significatifs</li>
                                        <li>Utilisez régulièrement l'outil d'analyse pour détecter les incohérences</li>
                                        <li>Ne supprimez pas les fichiers de sauvegarde (préfixe <code>backup_</code>)</li>
                                        <li>Pour mettre à jour un fichier standard, téléchargez-le d'abord, modifiez-le, puis réuploadez-le avec le même nom</li>
                                        <li>Regroupez vos codes par domaine fonctionnel dans des fichiers distincts</li>
                                    </ol>
                                </div>
                            </div>
                        </div>

                        <div class="faq-item">
                            <div class="faq-question">
                                <span class="faq-icon">Q</span>
                                <h4>Puis-je supprimer les fichiers de sauvegarde ?</h4>
                            </div>
                            <div class="faq-answer">
                                <span class="faq-icon">R</span>
                                <div class="faq-answer-content">
                                    <p>Techniquement oui, mais ce n'est pas recommandé :</p>
                                    <ul>
                                        <li>Ils occupent très peu d'espace disque</li>
                                        <li>Ils offrent une protection précieuse en cas de corruption</li>
                                        <li>Sans eux, le système devra générer des fichiers par défaut vides en cas de problème</li>
                                    </ul>
                                    <p>Ces sauvegardes font partie des améliorations pour garantir une fiabilité à 100% du système.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <footer class="content-footer">
                <div class="footer-content">
                    <p id="footer-version"></p>
                    <p class="copyright">© FHIRHub 2025. Tous droits réservés.</p>
                </div>
            </footer>
        </div>
    </div>
</body>
</html>